'use strict';

const path = require('path');
const { readFileSync } = require('fs');
const { expect } = require('chai');

describe('SourceMapConsumer', function() {
  let consumer, map;
  beforeEach(function() {
    const { SourceMapConsumer } = require('../index');

    const mapPath = path.join(__dirname, 'example.js.map');

    map = JSON.parse(readFileSync(mapPath));

    consumer = new SourceMapConsumer(map);
  });

  it('should properly resolve filenames', function() {
    const { source } = consumer.originalPositionFor({
      line: 12,
      column: 4
    });

    expect(source).to.equal('index.ts');
  });

  it('should properly resolve lines', function() {
    const { line } = consumer.originalPositionFor({
      line: 12,
      column: 4
    });

    expect(line).to.equal(9);
  });
});
